#!/bin/bash

JOURNAL="$HOME/Obsidian/hacking-journal/daily/$(date +%F).md"
[ ! -f "$JOURNAL" ] && { echo "âŒ No journal found: $JOURNAL"; exit 1; }

declare -A sections=(
  ["ğŸ§  Hacking Log"]="Hacking Log"
  ["ğŸ•’ Time Started"]="Time Started"
  ["ğŸ“‹ Commands Run"]="Commands Run"
  ["âœ… Learning Detected"]="Learning Detected"
  ["ğŸ•’ Session Ended"]="Session Ended"
  ["ğŸ›  Tools Used"]="Tools Used"
  ["ğŸ” Target / Lab"]="Target / Lab"
  ["âœ… Results"]="Results"
  ["ğŸ§  Lessons Learned"]="Lessons Learned"
  ["â“ Follow-ups"]="Follow-ups"
)

echo "ğŸ“‹ Checking automation in: $JOURNAL"
echo

for header in "${!sections[@]}"; do
  label="${sections[$header]}"
  if grep -q "$header" "$JOURNAL"; then

    content=$(awk -v h="## $header" '$0 ~ h {getline; print}' "$JOURNAL" | sed 's/^[[:space:]]*//')
    if [[ -n "$content" && "$content" != "-" ]]; then
      echo "âœ… $label â†’ Auto-filled"
    else
      echo "âš ï¸  $label â†’ Exists but empty"
    fi
  else
    echo "âŒ $label â†’ Missing!"
  fi
done
